package com.micromall.payment;import java.io.UnsupportedEncodingException;import java.security.MessageDigest;import java.security.NoSuchAlgorithmException;/** * 类名：MD5签名处理类 功能：MD5签名处理核心类 */public class MD5Utils {	/**	 * get the md5 hash of a string	 *	 * @param str	 * @return	 */	public static String md5(String str, String charset) {		if (str == null) {			return null;		}		if (charset == null) {			charset = "UTF-8";		}		MessageDigest messageDigest;		try {			messageDigest = MessageDigest.getInstance("MD5");			messageDigest.reset();			messageDigest.update(str.getBytes(charset));		} catch (NoSuchAlgorithmException e) {			return str;		} catch (UnsupportedEncodingException e) {			return str;		}		byte[] byteArray = messageDigest.digest();		StringBuffer md5StrBuff = new StringBuffer();		for (int i = 0; i < byteArray.length; i++) {			if (Integer.toHexString(0xFF & byteArray[i]).length() == 1) {				md5StrBuff.append("0").append(Integer.toHexString(0xFF & byteArray[i]));			} else {				md5StrBuff.append(Integer.toHexString(0xFF & byteArray[i]));			}		}		return md5StrBuff.toString();	}}