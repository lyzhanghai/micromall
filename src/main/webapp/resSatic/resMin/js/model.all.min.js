var servicePath="http://www.u-non.com/api/",app=angular.module("app",["ui.router","ngSanitize","angularLazyImg","angular-carousel","ngFileUpload","ngModal","china-area-selector","cz-mobile"],["$compileProvider","$locationProvider",function(t,e){e.html5Mode(!0).hashPrefix("!"),t.aHrefSanitizationWhitelist(/^\s*((https?|ftp|tel|sms|mailto|file|javascript|chrome-extension):)|#/)}]);app.controller("mainController",["$scope","$rootScope","userInfoService",function(t,e,r){e.loading=!1,e.prefix="/",e.userInfoData={},r.userInfo(function(t){e.userInfoData=t.data})}]),app.directive("back",["$timeout",function(t){return{restrict:"EA",link:function(e,r,a){t(function(){e.$on("$destroy",function(){r.off()}),r.bind("click",function(){window.history.go(-1),console.log(1)})},0)}}}]),app.factory("authorFactory",["$rootScope",function(t){return function(e){var r=location.origin+t.prefix+e.href+"?"+angular.param(e.data||{});location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxa66a636535c987db&redirect_uri="+encodeURIComponent(r)+"&response_type=code&scope=snsapi_base&state=123#wechat_redirect"}}]),app.filter("dateDay",function(){return function(t){var e=(new Date).getTime()-new Date(t).getTime(),r=parseInt(e/36e5-1);if(r>=72){var a=new Date(t);r=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()}else if(r>=24)r=parseInt(r/24)+"天前";else if(0==r){var o=parseInt(e/6e4);r=o>=60?"1小时前":o+"分钟前"}else r+="小时前";return r}}).filter("cut",function(){var t=0,e="",r=!0;return function(a,o){return angular.forEach(a,function(a,i){if(r){if(";"===a)return void(t===o?r=!1:t++);t>=o&&(e+=a)}}),e}}).filter("encodeUrl",function(){return function(t){return encodeURIComponent(t)}}).filter("toFixed",function(){return function(t){return t?t.toFixed(2):t}}).filter("to_trusted",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]),app.factory("authHttpResponseInterceptor",["$q","$location","$rootScope","$injector",function(t,e,r,a){function o(){i=!0,r.loading=!1}var i=!1;return{request:function(t){var t=t||{};return t.timeout=1e4,t.load=t.load||!0,i=!1,t.url.indexOf(".html")>-1||t.url.indexOf("json")>-1?t:(t.load&&!i&&(r.loading=!0),"GET"==t.method?(t.params=t.params||{},t.params.debugAuth="debugAuth",t.params.PAJAX="true"):(t.data=t.data||{},t.data.debugAuth="debugAuth",t.data.PAJAX="true"),t)},response:function(e){var r=a.get("messageFactory");if("object"==typeof e.data&&e.data.code&&"number"==typeof e.data.code){switch(e.data.code){case-1:r({text:"请登录"}),location.href=e.data.data;break;case 1:r({text:e.data.msg})}return o(),t.reject(e)}return o(),e||t.when(e)},responseError:function(e){var r=a.get("messageFactory");return o(),r({text:"服务器出错请求出错"}),t.reject(e)}}}]),browser.v.ios9&&app.config(["$provide",function(t){t.decorator("$browser",["$delegate",function(t){var e=t.url,r=null,a=null,o=function(t,o,i){if(t){var n=e(t,o,i);if(window.location.href==t||r==t)return;return r=t,a&&clearTimeout(a),a=setTimeout(function(){window.location.href==r&&(r=null),a=null},0),n}return r==window.location.href&&(r=null),r||e(t,o,i)};return t.url=o,t}])}]),function(t){var e=[{name:"index",url:"/indexMain.html",templateUrl:"view/indexMain.html",controller:"indexCtr",tabSelectIndex:1},{name:"goodsList",url:"/goodsList.html?:{searchText || categoryId}",templateUrl:"view/goodsList.html",controller:"goodsListCtr",tabSelectIndex:2},{name:"detail",url:"/detail.html?:goodsId",templateUrl:"view/detail.html",controller:"detailCtr",tabSelectIndex:2},{name:"shopCart",url:"/shopCart.html",templateUrl:"view/shopCart.html",controller:"shopCartCtr",tabSelectIndex:4},{name:"userInfo/info",url:"/userContent/info.html",templateUrl:"view/userContent/info.html",controller:"userInfoCtr",tabSelectIndex:3},{name:"userInfo/myMessage",url:"/userContent/myMessage.html",templateUrl:"view/userContent/myMessage.html",controller:"myMessageCtr",tabSelectIndex:3},{name:"userInfo/collect",url:"/userContent/collect.html",templateUrl:"view/userContent/collect.html",controller:"userCollectCtr",tabSelectIndex:3},{name:"userInfo/setUp",url:"/userContent/setUp.html",templateUrl:"view/userContent/setUp.html",controller:"",tabSelectIndex:3},{name:"userInfo/setInfo",url:"/userContent/setUp/setInfo.html",templateUrl:"view/userContent/setUp/setInfo.html",controller:"setInfoCtr",tabSelectIndex:3},{name:"userInfo/identity",url:"/userContent/setUp/identity.html",templateUrl:"view/userContent/setUp/identity.html",controller:"identityCtr",tabSelectIndex:3},{name:"userInfo/siteList",url:"/userContent/site/list.html?:isSelectAddress",templateUrl:"view/userContent/site/siteList.html",controller:"siteListCtr",tabSelectIndex:3},{name:"userInfo/siteAddEdit",url:"/userContent/site/addEdit.html?:id",templateUrl:"view/userContent/site/siteAddEdit.html",controller:"siteAddEditCtr",tabSelectIndex:3},{name:"userInfo/myDistributor",url:"/userContent/distributor/myDistributor.html",templateUrl:"view/userContent/distributor/myDistributor.html",controller:"myDistributorCtr",tabSelectIndex:3},{name:"userInfo/distributorOrder",url:"/userContent/distributor/distributorOrder.html",templateUrl:"view/userContent/distributor/distributorOrder.html",controller:"distributorOrderCtr",tabSelectIndex:3},{name:"userInfo/distributorDraw",url:"/userContent/distributor/distributorDraw.html",templateUrl:"view/userContent/distributor/distributorDraw.html",controller:"distributorDrawCtr",tabSelectIndex:3},{name:"userInfo/distributorRecord",url:"/userContent/distributor/distributorRecord.html",templateUrl:"view/userContent/distributor/distributorRecord.html",controller:"distributorRecordCtr",tabSelectIndex:3},{name:"order/createOrder",url:"/order/createOrder.html?:goodsIds&:buyNumber&:cart",templateUrl:"view/order/createOrder.html",controller:"createOrderCtr",tabSelectIndex:3},{name:"order/pay",url:"/order/pay.html?:orderNo&:price",templateUrl:"view/order/pay.html",controller:"payCtr",tabSelectIndex:3},{name:"order/myOrderList",url:"/order/myOrder/myOrderList.html?:status",templateUrl:"view/order/myOrder/myOrderList.html",controller:"myOrderListCtr",tabSelectIndex:3},{name:"order/myOrderDetail",url:"/order/myOrder/myOrderDetail.html?:orderNo",templateUrl:"view/order/myOrder/myOrderDetail.html",controller:"myOrderDetailCtr",tabSelectIndex:3},{name:"order/logistic",url:"/order/logistic.html?:orderNo",templateUrl:"view/order/logistic.html",controller:"logisticCtr",tabSelectIndex:3}];t.config(["$stateProvider","$urlRouterProvider","$httpProvider","lazyImgConfigProvider","czContentForConfigProvider",function(t,r,a,o,i){o.setOptions({startClass:"startImg",successClass:"loadSuccessImg"}),a.interceptors.push("authHttpResponseInterceptor"),a.defaults.headers.put["Content-Type"]="application/x-www-form-urlencoded",a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",a.defaults.headers.common.Accept="application/json, text/plain, */*",a.defaults.transformRequest=[function(t){return angular.isObject(t)&&"[object File]"!==String(t)?angular.param(t):t}],e.forEach(function(e){var r={name:e.name,url:e.url,tabSelectIndex:e.tabSelectIndex,views:{}};r.views[e.uiView||"appState"]={templateUrl:e.templateUrl,controller:e.controller},t.state(r)}),r.otherwise("/indexMain.html")}])}(app),app.run(["$rootScope","$http","$timeout",function(t,e,r){t.$on("$stateChangeSuccess",function(e,r,a){r.tabSelectIndex&&(t.targetScope=r.tabSelectIndex)})}]),app.factory("orderCacheFactory",function(){return{myOrderListNavTab:[{id:0,name:"待付款"},{id:1,name:"待发货"},{id:2,name:"待收货"},{id:3,name:"已完成"},{id:4,name:"已取消"}]}}),app.controller("htlistCrt",["$scope","$rootScope","$stateParams","htlistService",function(t,e,r,a){t.$parent.empty=!1,t.$parent.async=!1,t.$parent.listData=[],t.load=function(){t.empty||t.async||(t.async=!0,a.list(t.getData,function(e){e.data.length<t.getData.limit&&(t.empty=!0),e.data.forEach(function(e){t.listData.push(e)}),t.async=!1,t.getData.page++}))},t.tabFilter=function(e,r){t.empty=!1,t.getData.page=1,t.getData.sort==e?t.getData.sort=r:t.getData.sort=e,t.load()},t.load()}]),app.service("htlistService",["$http",function(t){this.list=function(e,r){t.get(servicePath+"goods/search",{params:e}).success(r)}}]),app.controller("goodsListCtr",["$scope","$rootScope","$stateParams","goodsListCacheFactory","goodsListService",function(t,e,r,a,o){var i=!1,n=!1;t.bannerConfData={},t.tabData=a.navTab,t.category=a.category,t.listData=[],t.getData={query:r.searchText,categoryId:r.categoryId,sort:"volume_desc",page:1,limit:10},t.searchList=function(){location.href=e.prefix+"goodsList.html?searchText="+t.search},o.indexAdConfig(function(e){t.bannerConfData=e.data.banner}),t.load=function(){i||n||(n=!0,o.searchList(t.getData,function(e){e.data.length<t.getData.limit&&(i=!0),e.data.forEach(function(e){t.listData.push(e)}),n=!1,t.getData.page++}))},t.tabFilter=function(e,r){i=!1,t.getData.page=1,t.listData=[],t.getData.sort==e?t.getData.sort=r:t.getData.sort=e,t.load()}}]),app.factory("goodsListCacheFactory",function(){return{navTab:[{name:"按销量",up:"volume_desc",dowm:"volume_asc"},{name:"按价格",up:"price_desc",dowm:"price_asc"},{name:"按上架",up:"time_desc",dowm:"time_asc"}],category:[{id:101,name:"大米杂粮"},{id:102,name:"各地特产"},{id:103,name:"手作食材"},{id:104,name:"时令水果"},{id:105,name:"特价促销"}]}}),app.service("goodsListService",["$http",function(t){this.searchList=function(e,r){t.get(servicePath+"goods/search",{params:e}).success(r)},this.indexAdConfig=function(e){t.get(servicePath+"index_ad_config",{}).success(e)}}]),app.controller("detailCtr",["$scope","$rootScope","$stateParams","detailService","messageFactory",function(t,e,r,a,o){var i={goodsId:r.goodsId},n=!1;t.buyDialog=!1,t.detailData={},t.getData=angular.extend({buyNumber:1,cart:!1},i),a.detailData(i,function(e){t.detailData=e.data}),t.addFavorite=function(){n||(n=!0,t.detailData.favorite?a.deleteFavorite(i,function(e){t.detailData.favorite=!t.detailData.favorite,o({text:"取消收藏"}),n=!1}):a.addFavorite(i,function(e){t.detailData.favorite=!t.detailData.favorite,o({text:"收藏成功"}),n=!1}))},t.numOption=function(e){if("redu"==e){if(t.getData.buyNumber<=0)return;t.getData.buyNumber--}else t.getData.buyNumber++},t.shopChangeNum=function(){var e=new RegExp(/^(\d)*$/);t.getData.buyNumber>t.detailData.inventory&&(t.getData.buyNumber=t.detailData.inventory),e.test(t.getData.buyNumber)||(t.getData.buyNumber=1)},t.shopBlurNum=function(){t.getData.buyNumber=parseInt(t.getData.buyNumber),(t.getData.buyNumber<=0||!t.getData.buyNumber)&&(t.getData.buyNumber=1)},t.buyDialogToggle=function(){t.buyDialog=!t.buyDialog},t.go=function(e){t.getData.cart=e,t.buyDialogToggle()},t.placeOrder=function(){var r={goodsIds:i.goodsId,buyNumber:t.getData.buyNumber,cart:t.getData.cart};t.getData.cart?a.addCart(t.getData,function(e){t.buyDialogToggle(),o({text:"加入购物车成功"})}):location.href=e.prefix+"order/createOrder.html?"+angular.param(r)}}]),app.service("detailService",["$http",function(t){this.detailData=function(e,r){t.get(servicePath+"goods/details",{params:e}).success(r)},this.addFavorite=function(e,r){t.post(servicePath+"favorite/join",e).success(r)},this.deleteFavorite=function(e,r){t.post(servicePath+"favorite/delete",e).success(r)},this.addCart=function(e,r){t.post(servicePath+"cart/join",e).success(r)}}]),app.controller("indexCtr",["$scope","$rootScope","indexService",function(t,e,r){t.indexConfData={},t.indexRecommend={},t.getData={sort:"volume_desc",page:1,limit:10},r.indexAdConfig(function(e){t.indexConfData=e.data}),r.indexList({promotion:!0,limit:3},function(e){t.indexRecommend=e.data}),t.searchList=function(){location.href=e.prefix+"goodsList.html?searchText="+t.search}}]),app.service("indexService",["$http",function(t){this.indexAdConfig=function(e){t.get(servicePath+"index_ad_config",{}).success(e)},this.indexList=function(e,r){t.get(servicePath+"goods/search",{params:e}).success(r)}}]),app.service("shopCartService",["$http",function(t){this.cartList=function(e){t.post(servicePath+"cart/list").success(e)},this.cartAdd=function(e,r){t.post(servicePath+"cart/join",e).success(r)},this.cartUpNum=function(e,r){t.post(servicePath+"cart/update_buyNumber",e).success(r)},this.cartDelete=function(e,r){t.post(servicePath+"cart/delete",e).success(r)},this.cartDeleteAll=function(e){t.post(servicePath+"cart/delete_all").success(e)}}]),app.controller("shopCartCtr",["$scope","$rootScope","shopCartService","confirmFactory","messageFactory",function(t,e,r,a,o){t.shopInfo={total:0,selectLength:0,selectArray:[]},t.shopData=[];var i=0,n=0,s=function(t){var a={buyNumber:t.buyNumber,goodsId:t.goodsId};r.cartUpNum(a,function(t){e.loading=!1})},c=function(){t.shopData.length==t.shopInfo.selectLength?t.allCheckSelect=!0:t.allCheckSelect=!1},u=function(t){t.itemTotal=parseFloat(t.itemCurPrice*t.buyNumber)},d=function(e,r){"add"==e?t.shopInfo.total=t.shopInfo.total+r:t.shopInfo.total=t.shopInfo.total-r},l=function(t,e,r){e&&d(t,r)};t.upShopRedu=function(t,e){e.buyNumber>1&&(e.buyNumber--,l("less",e.checkSelect,e.price),e.checkSelect&&(t.total-=parseFloat(e.price)),s(e),u(e))},t.upShopPuls=function(t,e){e.buyNumber<e.inventory&&(e.buyNumber++,l("add",e.checkSelect,e.price),e.checkSelect&&(t.total+=parseFloat(e.price)),s(e),u(e))},t.upShopNum=function(e,r){var a=new RegExp(/^(\d)*$/),o=parseInt(r.price);r.buyNumber>r.inventory&&(r.buyNumber=r.inventory),a.test(r.buyNumber)||(r.buyNumber=1),r.checkSelect&&(e.total=parseFloat(e.total-i*o+r.buyNumber*o),t.shopInfo.total=t.shopInfo.total-i*o+r.buyNumber*o),u(r),i=r.buyNumber},t.upShopFocusNum=function(t){i=n=t.buyNumber},t.upShopBlurNum=function(t){t.buyNumber=parseInt(t.buyNumber),n!=t.buyNumber&&(t.buyNumber||(t.buyNumber=1,u(t)),s(t))},t.checkSelect=function(e,r){if(r.checkSelect)t.shopInfo.selectLength++,d("add",r.price),t.shopInfo.selectArray.push(r.goodsId);else{t.shopInfo.selectLength--,d("less",r.price);var a=angular.inArray(r.goodsId,t.shopInfo.selectArray);a>-1&&t.shopInfo.selectArray.splice(a,1)}c()},t.allSelect=function(){t.shopInfo.selectArray=[],t.shopInfo.total=0,angular.forEach(t.shopData,function(e,r){t.allCheckSelect?(e.checkSelect=!0,t.shopInfo.selectLength++,d("add",e.price),t.shopInfo.selectArray.push(e.goodsId)):(t.shopInfo.selectLength=0,e.checkSelect=!1)})},t.deleteShop=function(e,i){a({scope:t,text:"你确定从购物车删除该物品吗？",option:{go:function(){r.cartDelete({goodsId:e.goodsId},function(r){var a=angular.inArray(e.goodsId,t.shopInfo.selectArray);a>-1&&(t.shopInfo.selectArray.splice(a,1),t.shopInfo.selectLength--,l("less",e.checkSelect,e.itemTotal)),t.shopData.splice(i,1),c(),o({text:"删除成功"})})}}})},t.deleteAll=function(){a({text:"你确定从购物车删除这些物品吗？",option:{go:function(){r.cartDeleteAll(function(e){t.allCheckSelect=!1,t.shopInfo.total=0,t.shopInfo.selectArray=[],t.shopData=[]})}}})},t.submit=function(){var r={goodsIds:t.shopInfo.selectArray.join(","),cart:!0};location.href=e.prefix+"order/createOrder.html?"+angular.param(r)},r.cartList(function(e){t.shopData=e.data})}]),app.factory("distributorCacheFactory",function(){return{myDistributorNavTab:[{name:"全部"},{level:"lv1",name:"一级"},{level:"lv2",name:"二级"}],recordTab:[{name:"全部"},{status:"through",name:"已通过"},{status:"not_through",name:"未通过"},{status:"audit",name:"审核中"}]}}),app.controller("createOrderCtr",["$scope","$rootScope","$stateParams","authorFactory","createOrderService",function(t,e,r,a,o){t.createOrderData={},t.leaveMessage="",o.getCartGoods(r,function(e){t.createOrderData=e.data,sessionStorage.selectAddress&&(e.data.address=JSON.parse(sessionStorage.selectAddress),sessionStorage.selectAddress=""),e.data.address&&t.calculateFreight()}),t.calculateFreight=function(){o.calculateFreight({addressId:t.createOrderData.address.id,settleId:t.createOrderData.settle.settleId},function(e){t.createOrderData.settle.freight=e.data.freight,t.createOrderData.settle.totalAmount=e.data.totalAmount})},t.selectAddress=function(){location.href=e.prefix+"userContent/site/list.html?isSelectAddress=true"},t.goPay=function(){o.buy({settleId:t.createOrderData.settle.settleId,leaveMessage:t.leaveMessage},function(t){a({href:"order/pay.html",data:{orderNo:t.data.orderNo,price:t.data.amount}})})}}]),app.service("createOrderService",["$http",function(t){this.getCartGoods=function(e,r){t.post(servicePath+"cart/settle",e).success(r)},this.calculateFreight=function(e,r){t.post(servicePath+"cart/settle/calculateFreight",e).success(r)},this.buy=function(e,r){t.post(servicePath+"cart/settle/buy",e).success(r)}}]),app.controller("logisticCtr",["$scope","$stateParams","logisticsService",function(t,e,r){t.logisticData={},r.logistics({orderNo:e.orderNo},function(e){t.logisticData=e.data})}]),app.service("logisticsService",["$http",function(t){this.logistics=function(e,r){t.post(servicePath+"my_orders/logistics",e).success(r)}}]),app.controller("myOrderDetailCtr",["$scope","$rootScope","$stateParams","myOrderDetailService","confirmFactory","authorFactory","messageFactory",function(t,e,r,a,o,i,n){var s={orderNo:r.orderNo};t.orderDetail={},a.detail(s,function(e){t.orderDetail=e.data}),t.goPay=function(e){i({href:"order/pay.html",data:{orderNo:t.orderDetail.item.orderNo,price:t.orderDetail.totalAmount}})},t.confirmDelivery=function(){o({scope:t,text:"确定收到物品？",option:{go:function(){a.confirmDelivery(s,function(){n({text:"确认收货成功"}),t.orderDetail.status=3})}}})}}]),app.controller("myOrderListCtr",["$scope","$rootScope","$stateParams","myOrderListService","orderCacheFactory","confirmFactory","authorFactory","messageFactory",function(t,e,r,a,o,i,n,s){var c=!1;t.applyEfundMoadl=!1,t.getData={status:r.status,page:1,limit:10},t.applyEfundItemData={orderNo:0,refundReason:""},t.navTab=o.myOrderListNavTab,t.async=!1,t.listData=[],t.load=function(){c||t.async||(t.async=!0,a.ordersList(t.getData,function(e){e.data.length<t.getData.limit&&(c=!0),e.data.forEach(function(e){t.listData.push(e)}),t.getData.page++,t.async=!1}))},t.orderClose=function(e,r){i({scope:t,text:"确定要关闭订单？",option:{go:function(){a.closeOrder({orderNo:e},function(){s({text:"关闭订单成功"}),t.listData.splice(r,1)})}}})},t.confirmDelivery=function(e,r){i({scope:t,text:"确定收到物品？",option:{go:function(){a.confirmDelivery({orderNo:e},function(){s({text:"确认收货成功"}),t.listData.splice(r,1)})}}})},t.goPay=function(t){n({href:"order/pay.html",data:{orderNo:t.orderNo,price:t.totalAmount}})},t.applyEfund=function(e){t.applyEfundMoadl=!0,t.applyEfundItemData={orderNo:e}},t.efundMoadlTot=function(){t.applyEfundMoadl=!t.applyEfundMoadl},t.applyEfundSuc=function(){a.applyRefund(t.applyEfundItemData,function(){s({text:"退款申请提交成功"}),t.navTabClick(4),t.efundMoadlTot()})},t.load()}]),app.service("myOrderDetailService",["$http",function(t){this.detail=function(e,r){t.post(servicePath+"my_orders/details",e).success(r)},this.confirmDelivery=function(e,r){t.post(servicePath+"my_orders/confirm_delivery",e).success(r)}}]),app.service("myOrderListService",["$http",function(t){this.ordersList=function(e,r){t.post(servicePath+"my_orders/orders",e).success(r)},this.closeOrder=function(e,r){t.post(servicePath+"my_orders/close",e).success(r)},this.confirmDelivery=function(e,r){t.post(servicePath+"my_orders/confirm_delivery",e).success(r)},this.applyRefund=function(e,r){t.post(servicePath+"my_orders/apply_refund",e).success(r)}}]),app.service("payService",["$http",function(t){this.pay=function(e,r){t.post(servicePath+"order/pay",e).success(r)}}]),app.controller("payCtr",["$scope","$rootScope","$stateParams","payService",function(t,e,r,a){function o(t){WeixinJSBridge.invoke("getBrandWCPayRequest",t,function(t){"get_brand_wcpay_request:ok"==t.err_msg||"get_brand_wcpay_request:cancel"==t.err_msg?location.href=e.prefix+"order/myOrder/myOrderList.html?status=1":alert("发生未知错误")})}function i(t){"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",function(){o(t)},!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",function(){o(t)}),document.attachEvent("onWeixinJSBridgeReady",function(){o(t)})):o(t)}t.data=r,t.submit=function(){a.pay({orderNo:t.data.orderNo},function(t){i(t.data)})}}]),app.controller("distributorDrawCtr",["$scope","$rootScope","distributorDrawService",function(t,e,r){t.getData={channel:"WECHAT"},t.submit=function(){r.apply(t.getData,function(){location.href=e.prefix+"userContent/distributor/distributorRecord.html"})}}]),app.controller("distributorOrderCtr",["$scope","$rootScope","distributorOrderService",function(t,e,r){t.data={},t.distributorTabList={},t.tabSelectId="lv1",t.tab=[{id:"lv1",name:"一级分销商"},{id:"lv2",name:"二级分销商"}],t.distributorListToggle=function(e){t.tabSelectId=e,t.distributorTabList=t.data[e]},r.distributorsStat(function(e){t.data=e.data,t.distributorListToggle(t.tabSelectId)})}]),app.controller("distributorRecordCtr",["$scope","$rootScope","distributorCacheFactory","distributorRecordService",function(t,e,r,a){t.listData=[],t.tab=r.recordTab,t.getData={},t.selectTav=function(e){t.getData.status=e,a.records(t.getData,function(e){t.listData=[],t.listData=e.data})},t.selectTav(t.tab[0].status)}]),app.controller("myDistributorCtr",["$scope","$rootScope","myDistributorService","distributorCacheFactory",function(t,e,r,a){var o=!1;t.async=!1,t.distributorsData={startData:{},listData:[]},t.getData={level:"lv1",page:1,limit:10},t.navTab=a.myDistributorNavTab,r.distributorsStat(function(e){t.distributorsData.startData=e.data}),t.load=function(){t.async||o||(t.async=!0,r.distributorsList(t.getData,function(e){e.data.forEach(function(r){t.distributorsData.listData.push(r),e.data.length<t.getData.limit&&(o=!0),t.async=!1})}))},t.navTabClick=function(e){t.distributorsData.listData=[],o=!1,e?t.getData.level=e:delete t.getData.level,t.load()}}]),app.service("distributorDrawService",["$http",function(t){this.apply=function(e,r){t.post(servicePath+"withdraw/apply",e).success(r)}}]),app.service("distributorOrderService",["$http",function(t){this.distributorsStat=function(e){t.get(servicePath+"distribution/commission_stat").success(e)}}]),app.service("distributorRecordService",["$http",function(t){this.records=function(e,r){t.post(servicePath+"withdraw/records",e).success(r)}}]),app.service("myDistributorService",["$http",function(t){this.distributorsStat=function(e){t.get(servicePath+"distribution/lower_distributors_stat").success(e)},this.distributorsList=function(e,r){t.post(servicePath+"distribution/lower_distributors_list",e).success(r)}}]),app.controller("myMessageCtr",["$scope","$rootScope","myMessageService",function(t,e,r){var a={page:1,limit:10},o=!1;t.listData=[],t.load=function(){o||(o=!0,r.list(a,function(e){e.data.forEach(function(e){t.listData.push(e)}),e.data.length>=a.limit&&(o=!1),a.page++}))},t.load()}]),app.service("myMessageService",["$http",function(t){this.list=function(e,r){t.post(servicePath+"message/list",e).success(r)}}]),app.controller("identityCtr",["$scope","$rootScope","Upload","messageFactory","identityService",function(t,e,r,a,o){var i;t.isVlidate=!t.userInfoData.certifiedInfo||9==t.userInfoData.certifiedInfo.status||t.userInfoData.certifiedInfo.auditlog,t.getData={},t.upload=function(e,a){t.isVlidate||r.upload({url:servicePath+"member/upload_certificate",data:{file:a,username:t.username}}).then(function(r){1===e?t.getData.idCarImage1=r.data:t.getData.idCarImage0=r.data})},t.submit=function(){o.certification(t.getData,function(){a({text:"正在提交审核"}),e.userInfoData.certifiedInfo.status=0})},i=t.$watch("userInfoData.certifiedInfo",function(e){e&&angular.extend(t.getData,e)}),t.$on("$destroy",function(){i()})}]),app.controller("setInfoCtr",["$scope","$rootScope","$timeout","Upload","messageFactory","setInfoService",function(t,e,r,a,o,i){t.userInfo={};var n=t.$watch("userInfoData",function(r){r&&(angular.extend(t.userInfo,e.userInfoData),console.log(t.userInfo))});t.$on("$destroy",function(){n()}),t.upload=function(e){a.upload({url:servicePath+"member/update_avatar",data:{file:e,username:t.username}}).then(function(e){t.userInfo.avatar=e.data})},t.submit=function(){i.updateBasisinfo(t.userInfo,function(){e.userInfoData=angular.copy(t.userInfo)})}}]),app.service("identityService",["$http",function(t){this.certification=function(e,r){t.post(servicePath+"member/certification",e).success(r)}}]),app.service("setInfoService",["$http",function(t){this.updateBasisinfo=function(e,r){t.post(servicePath+"member/update_basisinfo",e).success(r)}}]),app.controller("siteAddEditCtr",["$scope","$stateParams","siteAddEditService","messageFactory",function(t,e,r,a){var o=e.id;t.toggleModal=function(){t.modalShown=!t.modalShown},t.addressItemData={defaul:!1},t.address={},o&&(t.addressItemData.id=o,r.addressGet(t.addressItemData,function(e){t.addressItemData=e.data,angular.extend(t.address,t.addressItemData)})),t.siteSelect=function(){angular.extend(t.addressItemData,t.address),t.toggleModal()},t.submit=function(){o?r.addressUpdate(t.addressItemData,function(){window.history.go(-1)}):r.addressAdd(t.addressItemData,function(){window.history.go(-1)})}}]),app.controller("siteListCtr",["$scope","$stateParams","siteListService","messageFactory",function(t,e,r,a){t.listData=[],r.addressList(function(e){t.listData=e.data}),t.deleteItem=function(e,o){r["delete"]({id:e},function(){t.listData.splice(o,1),a({text:"删除成功"})})},t.defaulAddress=function(o){return e.isSelectAddress?(sessionStorage.selectAddress=JSON.stringify(o),void window.history.back()):void(o.defaul||r.defaulAddress(o,function(){a({text:"设为默认地址成功"}),t.listData.forEach(function(t){t.id!=o.id&&(t.defaul=!1)})}))}}]),app.service("siteAddEditService",["$http",function(t){this.addressAdd=function(e,r){t.post(servicePath+"address/add",e).success(r)},this.addressUpdate=function(e,r){t.post(servicePath+"address/update",e).success(r)},this.addressGet=function(e,r){t.post(servicePath+"address/get",e).success(r)}}]),app.service("siteListService",["$http",function(t){this.addressList=function(e){t.get(servicePath+"address/list").success(e)},this["delete"]=function(e,r){t.post(servicePath+"address/delete",e).success(r)},this.defaulAddress=function(e,r){t.post(servicePath+"address/update",e).success(r)}}]),app.controller("userCollectCtr",["$scope","userCollectService","messageFactory",function(t,e,r){t.listData=[],e.favoriteList(function(e){t.listData=e.data}),t.deleteItem=function(a,o){e.favoriteDeleteItem({goodsId:a},function(){t.listData.splice(o,1),r({text:"删除成功"})})},t.deleteAll=function(a,o){e.favoriteDeleteAll(function(){t.listData=[],r({text:"删除全部成功"})})}}]),app.service("userCollectService",["$http",function(t){this.favoriteList=function(e){t.get(servicePath+"favorite/list").success(e)},this.favoriteDeleteItem=function(e,r){t.post(servicePath+"favorite/delete",e).success(r)},this.favoriteDeleteAll=function(e){t.post(servicePath+"favorite/delete_all").success(e)}}]),app.controller("userInfoCtr",["$scope","userInfoCacheFactory","userInfoService",function(t,e,r){t.orderNum={},t.navTab=e.navTab,t.orderStateData=e.orderState,t.navTabClick=function(e){t.navTabSelectId=e},r.orderNum(function(e){t.orderNum=e.data}),t.navTabClick(t.navTab[0].id)}]),app.factory("userInfoCacheFactory",function(){return{navTab:[{id:1,name:"普通会员"},{id:2,name:"分销会员"}],orderState:[{hrefStatus:0,key:"waitPay",name:"待付款",icon:"icon-daifukuan"},{hrefStatus:1,key:"waitDelivery",name:"待发货",icon:"icon-daifahuo"},{hrefStatus:2,key:"waitReceive",name:"待收货",icon:"icon-daishouhuo"},{hrefStatus:3,key:"complete",name:"已完成",icon:"icon-yiwanchengdingdan"},{hrefStatus:4,key:"refund_closed",name:"退款/取消",icon:"icon-tixian1"}]}}),app.service("userInfoService",["$http",function(t){this.userInfo=function(e){t.get(servicePath+"member/userinfo").success(e)},this.orderNum=function(e){t.get(servicePath+"my_orders/statistics").success(e)}}]);